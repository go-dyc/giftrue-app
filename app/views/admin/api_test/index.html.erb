<div class="px-4 sm:px-6 lg:px-8">
  <div class="sm:flex sm:items-center">
    <div class="sm:flex-auto">
      <h1 class="text-2xl font-semibold text-gray-900">ë„¤ì´ë²„ API í…ŒìŠ¤íŠ¸</h1>
      <p class="mt-2 text-sm text-gray-700">
        ë„¤ì´ë²„ ì»¤ë¨¸ìŠ¤ API ì—°ë™ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
    </div>
  </div>

  <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- API ì—°ê²° í…ŒìŠ¤íŠ¸ -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ”Œ API ì—°ê²° í…ŒìŠ¤íŠ¸</h3>
      <p class="text-sm text-gray-600 mb-4">í™˜ê²½ë³€ìˆ˜ ì„¤ì • ë° ì„œë¹„ìŠ¤ ì´ˆê¸°í™”ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
      
      <button id="test-connection" class="btn-primary w-full mb-4">
        ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      </button>
      
      <div id="connection-result" class="hidden">
        <div class="bg-gray-50 rounded-lg p-4">
          <pre id="connection-output" class="text-sm text-gray-800 whitespace-pre-wrap"></pre>
        </div>
      </div>
    </div>

    <!-- í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸ -->
    <div class="bg-white shadow rounded-lg p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ”‘ í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸</h3>
      <p class="text-sm text-gray-600 mb-4">OAuth2 Access Token ë°œê¸‰ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p>
      
      <button id="test-token" class="btn-primary w-full mb-4">
        í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸
      </button>
      
      <div id="token-result" class="hidden">
        <div class="bg-gray-50 rounded-lg p-4">
          <pre id="token-output" class="text-sm text-gray-800 whitespace-pre-wrap"></pre>
        </div>
      </div>
    </div>

    <!-- ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸ -->
    <div class="bg-white shadow rounded-lg p-6 lg:col-span-2">
      <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ“¦ ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸</h3>
      <p class="text-sm text-gray-600 mb-4">ì‹¤ì œ ì£¼ë¬¸ë²ˆí˜¸ë¡œ ìƒíƒœ ì¡°íšŒë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p>
      
      <div class="flex gap-4 mb-4">
        <input type="text" id="order-number" placeholder="ì£¼ë¬¸ë²ˆí˜¸ ì…ë ¥" 
               value="test1" class="form-input flex-1">
        <button id="test-order" class="btn-primary px-6">
          ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸
        </button>
      </div>
      
      <div id="order-result" class="hidden">
        <div class="bg-gray-50 rounded-lg p-4">
          <pre id="order-output" class="text-sm text-gray-800 whitespace-pre-wrap"></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- ì‹¤ì‹œê°„ ë¡œê·¸ -->
  <div class="mt-8 bg-white shadow rounded-lg p-6">
    <h3 class="text-lg font-medium text-gray-900 mb-4">ğŸ“‹ ì‹¤ì‹œê°„ ë¡œê·¸</h3>
    <div id="live-log" class="bg-black text-green-400 rounded-lg p-4 font-mono text-sm h-64 overflow-y-auto">
      <div class="text-gray-500">ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const logElement = document.getElementById('live-log');
  
  function addLog(message) {
    const timestamp = new Date().toLocaleTimeString();
    const logLine = document.createElement('div');
    logLine.textContent = `[${timestamp}] ${message}`;
    logElement.appendChild(logLine);
    logElement.scrollTop = logElement.scrollHeight;
  }
  
  function showResult(resultId, outputId, data) {
    document.getElementById(resultId).classList.remove('hidden');
    document.getElementById(outputId).textContent = JSON.stringify(data, null, 2);
  }
  
  // ì—°ê²° í…ŒìŠ¤íŠ¸
  document.getElementById('test-connection').addEventListener('click', async function() {
    addLog('API ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
    this.disabled = true;
    this.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
    
    try {
      const response = await fetch('/admin/api_test/connection');
      const data = await response.json();
      showResult('connection-result', 'connection-output', data);
      addLog(`ì—°ê²° í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ${data.status}`);
    } catch (error) {
      addLog(`ì—°ê²° í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
    } finally {
      this.disabled = false;
      this.textContent = 'ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤í–‰';
    }
  });
  
  // í† í° í…ŒìŠ¤íŠ¸
  document.getElementById('test-token').addEventListener('click', async function() {
    addLog('í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
    this.disabled = true;
    this.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
    
    try {
      const response = await fetch('/admin/api_test/token');
      const data = await response.json();
      showResult('token-result', 'token-output', data);
      addLog(`í† í° í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ${data.status}`);
    } catch (error) {
      addLog(`í† í° í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
    } finally {
      this.disabled = false;
      this.textContent = 'í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸';
    }
  });
  
  // ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸
  document.getElementById('test-order').addEventListener('click', async function() {
    const orderNumber = document.getElementById('order-number').value;
    addLog(`ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸ ì‹œì‘: ${orderNumber}`);
    this.disabled = true;
    this.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
    
    try {
      const response = await fetch(`/admin/api_test/order_check?order_number=${orderNumber}`);
      const data = await response.json();
      showResult('order-result', 'order-output', data);
      addLog(`ì£¼ë¬¸ ì¡°íšŒ ì™„ë£Œ: ${data.status}`);
    } catch (error) {
      addLog(`ì£¼ë¬¸ ì¡°íšŒ ì˜¤ë¥˜: ${error.message}`);
    } finally {
      this.disabled = false;
      this.textContent = 'ì£¼ë¬¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸';
    }
  });
});
</script>